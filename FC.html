
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Resting state functional connectivity: definition and analysis &#8212; fMRI data analysis, connectivity study</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Lab session : task fMRI analysis" href="Lab.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">fMRI data analysis, connectivity study</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction to fMRI data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="GLM.html">
   Task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab.html">
   Lab session : task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Resting state functional connectivity: definition and analysis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FFC.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/FC.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defintion-s">
   Defintion(s)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#identification-of-functional-networks-and-their-temporal-activity-during-rest">
   Identification of functional networks and their temporal activity during rest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation-analysis">
   Correlation analysis
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Resting state functional connectivity: definition and analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defintion-s">
   Defintion(s)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#identification-of-functional-networks-and-their-temporal-activity-during-rest">
   Identification of functional networks and their temporal activity during rest
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation-analysis">
   Correlation analysis
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="resting-state-functional-connectivity-definition-and-analysis">
<h1>Resting state functional connectivity: definition and analysis<a class="headerlink" href="#resting-state-functional-connectivity-definition-and-analysis" title="Permalink to this headline">#</a></h1>
<p>We have seen in the previous chapter a voxel-based analysis of connectivity in task fMRI with GLM. This type of modeling is not adapted to resting-state fMRI and does not allow to analyze connectivity between different brain regions. We have seen in the previous chapter a voxel-based analysis of connectivity in task fMRI with GLM. This type of modeling is not adapted to resting-state fMRI since it is impossible to define regressors in the absence of a paradigm and does not allow the analysis of connectivity at the scale of brain regions of interest to the neurologist/psychiatrist. The focus in this chapter is on the analysis of functional connectivity at the scale of anatomical regions or functional networks in task or resting state fMRI, and for group or single subject analyses.</p>
<section id="defintion-s">
<h2>Defintion(s)<a class="headerlink" href="#defintion-s" title="Permalink to this headline">#</a></h2>
<p>Functional connectivity is defined as the temporal similarity between activity of two (or more) different areas of the brain, <em>i.e.</em> theses regions co-activate to respond to a stimulus, to perform a cognitive task or to perform a spontaneous brain function. Regions that have a similar activity consistently over time form what is called a <strong>functional network</strong>.</p>
<p>In order to measure the similarity between the time signatures of two regions, different criteria can be used:</p>
<ul class="simple">
<li><p>the correlation between two signals which is the most commonly used measure in the literature,</p></li>
<li><p>the mutual information</p></li>
<li><p>partial correlation</p></li>
<li><p>coherence (in the frequency domain)</p></li>
<li><p>etc.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Connectivity as Pearson correlation coefficient</p>
<p>Let <span class="math notranslate nohighlight">\(x_i(n)\)</span> and <span class="math notranslate nohighlight">\(x_j(n)\)</span> be the discrete temporal signatures of the two regions <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> of interest.
Let <span class="math notranslate nohighlight">\(\bar{x}_i\)</span> and <span class="math notranslate nohighlight">\(\bar{x}_j\)</span> be the mean of <span class="math notranslate nohighlight">\(x_i(t)\)</span> and <span class="math notranslate nohighlight">\(x_j(t)\)</span> and <span class="math notranslate nohighlight">\(\sigma_i\)</span> and <span class="math notranslate nohighlight">\(\sigma_j\)</span> their standard deviation.
Correlation coefficient of regions <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> is computed as follows:</p>
<div class="math notranslate nohighlight" id="equation-corrcoef">
<span class="eqno">(1)<a class="headerlink" href="#equation-corrcoef" title="Permalink to this equation">#</a></span>\[r_{i,j} = \frac{1}{N}\sum_{n = 1}^{N} \frac{\left(x_i(n) - \bar{x}_i\right) \left(x_j(n) - \bar{x}_j\right)  }{\sigma_i \sigma_j}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of time samples in fMRI acquisition.</p>
</div>
<p>Two signals are strongly correlated in the Pearson sense if :</p>
<ul class="simple">
<li><p>they move in the same direction</p></li>
<li><p>they evolve in a synchronous way
The correlation is equal to 1 if and only if <span class="math notranslate nohighlight">\(x_i\)</span> can be written proportionally to <span class="math notranslate nohighlight">\(x_j\)</span>, i.e. if <span class="math notranslate nohighlight">\(x_i = \alpha x_j + \beta\)</span> with <span class="math notranslate nohighlight">\(alpha\)</span> and <span class="math notranslate nohighlight">\(beta\)</span> constants.</p></li>
</ul>
<p>In practice, Pearson correlation is the most widely used metric to quantify functional connectivity. Its main drawback is that it measures the presence of a linear relationship between the two signals. Spearman correlation or mutual information are able to capture non linear relationship but have their own limitations, in particular for further statistical analysis of connectivity. For example, the mutual information needs to be estimated, making assumptions on the distribution of the values taken by the signals. The distribution can be estimated by the histogram of the data which can be affected by noise (due to acquisition, preprocessings, etc.).</p>
</section>
<section id="identification-of-functional-networks-and-their-temporal-activity-during-rest">
<h2>Identification of functional networks and their temporal activity during rest<a class="headerlink" href="#identification-of-functional-networks-and-their-temporal-activity-during-rest" title="Permalink to this headline">#</a></h2>
<p>For task fMRI, GLM analysis is widely used, but for rest it is impossible to define regressors that represent spontaneous activity in the absence of stimuli. Most of the time, the search for functional networks at rest can be formulated, from a signal processing point of view, as a blind source separation problem. Indeed, it is a question of aggregating in the same network the voxels having a similar temporal signature. Remember that at rest signals contain mostly noise, spontaneous activity is more difficult to detect when we do not know when to look for useful information.</p>
<p>In some studies, certain anatomical regions are of interest for the pathology concerned. The neuroscientists then use an atlas (i.e. an anatomical segmentation of the brain) to extract timecourses of the voxels belonging to these regions of interest (ROI). A mean signal is then computed for each ROI and the connectivity can be measured by correlation, mutual information, etc. Since the registration of fMRI data to the atlas (or vice versa) is never perfect and the spatial resolution of voxels in fMRI is very coarse, more robust strategies than simple averaging can be used to extract the time course for each ROI. Since the registration of fMRI data to the atlas (or vice versa) is never perfect and the spatial resolution of voxels in fMRI is very coarse, more robust strategies than simple averaging can be used to extract the timecourse for each ROI. From a signal and image processing point of view, signal unmixing methods are adapted to refine the estimation of the timecourse, even if most of the time, simplicity prevails over accuracy. Functional networks are then created by gathering ROIs with high connectivity.</p>
<figure class="align-default" id="atlas">
<a class="reference internal image-reference" href="_images/atlas.png"><img alt="_images/atlas.png" src="_images/atlas.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Example of the Allen Human Brain atlas in sagital plane (left) and coronal plane (right), with two anatomical regions highlighted: hippocampal formation (orange) and amygdala (purple). Screenshot of Brain Explorer 2 application delivered by the Allen Institute for Brain Science.</span><a class="headerlink" href="#atlas" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>When one does not wish to work from predefined anatomical regions, functional networks can be directly extracted along with their temporal course via blind source separation methods. The most commonly used in fMRI is the independent component analysis (ICA). The size of the functional networks then depends on the number of components desired. With a low number of components, we obtain spatially extended networks, which then prevents a fine analysis of the connectivity, in particular in the case of the search for change of the functional connectivity due to a pathology. Conversely, with a very large number of independent components, we will estimate small networks, even functional sub-networks, but also many components that are in fact only noise. It then requires the help of a neuroscientist to exclude these nuisance components.
These blind source separation methods allow to obtain for each spatial source its time course. As for the ROI-based methods, a connectivity measure is then computed and the networks or sub-networks can be associated to form larger ones.</p>
<p>ICA-based methods perform well in group analyses because they take advantage of the redundancy within each group to produce the best possible independent components. At the single-subject level, these methods produce very noisy (spatial) independant components, on the other hand it is possible to extract functional networks by ICA on the group and then analyze at the individual level the temporal signatures of these networks for each subject.</p>
</section>
<section id="correlation-analysis">
<h2>Correlation analysis<a class="headerlink" href="#correlation-analysis" title="Permalink to this headline">#</a></h2>
<p>Once the signals of the networks or ROIs are extracted, we can implement a connectivity analysis through the calculation of correlation matrices. Many studies rely on these matrices to :</p>
<ul class="simple">
<li><p>identify functional networks or hidden structures in the correlation matrix revealing the functional activity of the patient,</p></li>
<li><p>detect differences in connectivity induced by a pathology by comparing a group of patient to a healthy control group.</p></li>
</ul>
<p>To find functional networks through the correlation matrix, we can threshold it to keep only the significantly correlated regions and identify structures in this thresholded matrix. Or one can rearrange the rows and columns of the correlation matrix in such a way as to bring the highly correlated regions closer together and form blocks around the diagonal of the matrix. It is then easier to identify the different networks by isolating the blocks in the diagonal of the matrix as illustrated on <a class="reference internal" href="#comp-corr"><span class="std std-numref">Fig. 11</span></a></p>
<figure class="align-default" id="comp-corr">
<a class="reference internal image-reference" href="_images/comp_corr.png"><img alt="_images/comp_corr.png" src="_images/comp_corr.png" style="height: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Same correlation matrix with rows and columns unsorted (left) and sorted by similarity (right).</span><a class="headerlink" href="#comp-corr" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><a class="reference external" href="https://moodle.unistra.fr/mod/quiz/view.php?id=627410">Activity : Analysing correlation matrices</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Lab.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lab session : task fMRI analysis</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Céline Meillier<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>