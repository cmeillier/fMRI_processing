
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction to fMRI data &#8212; fMRI data analysis, connectivity study</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Task fMRI analysis" href="GLM.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">fMRI data analysis, connectivity study</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Introduction to fMRI data
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="GLM.html">
   Task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Lab.html">
   Lab session : task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FC.html">
   Resting state functional connectivity: definition and analysis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fintro.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/intro.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#caracterization-of-fmri-data">
   Caracterization of fMRI data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#origin-of-fmri-data">
     Origin of fMRI data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-and-mathematical-model-of-fmri-data">
     Numerical and mathematical model of fMRI data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#studying-fmri-signal-with-signal-processing-tools">
   Studying fMRI signal with signal processing tools
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of contents
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Introduction to fMRI data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#caracterization-of-fmri-data">
   Caracterization of fMRI data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#origin-of-fmri-data">
     Origin of fMRI data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-and-mathematical-model-of-fmri-data">
     Numerical and mathematical model of fMRI data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#studying-fmri-signal-with-signal-processing-tools">
   Studying fMRI signal with signal processing tools
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of contents
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-fmri-data">
<h1>Introduction to fMRI data<a class="headerlink" href="#introduction-to-fmri-data" title="Permalink to this headline">#</a></h1>
<p>As part of the 4-hour course on functional MRI, you are invited to read the course and do the activities proposed to illustrate the theoretical part. You can go at your own pace, the practical application with Matlab lasts about 1h30. If you have not finished reading the course by the end of the 4 hours, you must finish before the final exam which will include questions on all the concepts covered in this document. During the whole session, you can work in groups, you can also ask questions that we will answer with the whole class when it is necessary to make a point.</p>
<hr class="docutils" />
<section id="caracterization-of-fmri-data">
<h2>Caracterization of fMRI data<a class="headerlink" href="#caracterization-of-fmri-data" title="Permalink to this headline">#</a></h2>
<section id="origin-of-fmri-data">
<h3>Origin of fMRI data<a class="headerlink" href="#origin-of-fmri-data" title="Permalink to this headline">#</a></h3>
<p>When the subject is performing an action (motor action, cognitive task, etc.) or at rest with spontaneous cerebral activities, specific neurons activate. Their activation leads to an increase in oxygen consumption, which implies an increasing of the blood flow locally in the brain to bring more oxygen. The oxygen, brought by hemoglobin (HbO2), is diamagnetic (Fe<span class="math notranslate nohighlight">\(^{++}\)</span> bound to O<span class="math notranslate nohighlight">\(_2\)</span>) and does not disturb the magnetic field, contrary to deoxyhemoglobin (Hb) which is paramagnetic since ions Fe<span class="math notranslate nohighlight">\(^{++}\)</span> remain unpaired.
Intuitively one might think that it is the oxygen consumption that is measured via the BOLD signal (Blood oxygen level dependent), but in reality it is the increase in blood flow which implies an overall increase in HbO2/Hb ratio. It is the variation of this rate, called BOLD contrast, that leads to a local disturbance of the magnetic field of the MRI and that is measured. We talk about <strong>indirect measure</strong> of brain activity because it is the disturbance of the magnetic field induced by the variation of oxygen in the blood caused by the activity of neurons that is acquired.</p>
<p>A nice animation to understand the BOLD contrast principle <a class="reference external" href="https://www.imaios.com/en/e-Courses/e-MRI/Functional-MRI/brain-activation-bold-contrast">IMAIOS ressource</a></p>
<p>The BOLD effect is very faint, it induces a variation of a few percents in the measured signal. The concentration of HbO2 and Hb are the following:</p>
<ul class="simple">
<li><p>at rest:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
    \begin{array}{l}
        60\% \mbox{ HbO}_2  \\
        40\% \mbox{ Hb}
    \end{array}
\right.\end{split}\]</div>
<ul class="simple">
<li><p>during task:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
    \begin{array}{l}
        63\% \mbox{ HbO}_2  \\
        37\% \mbox{ Hb}
    \end{array}
\right.\end{split}\]</div>
<p>During a task, only voxels containing the neurons activated to respond to the required function are expected to exhibit a change in the BOLD signal. Since the signal variation is very small and the fMRI signal is very noisy, it is necessary to repeat the action several times in order to statistically guarantee the detection of activated regions (see section on paradigm design).</p>
<p>A nice animation to understand the statistical analysis of fMRI data : <a class="reference external" href="https://www.imaios.com/en/e-Courses/e-MRI/Functional-MRI/analysis-functional-mri-data">IMAIOS ressource</a></p>
</section>
<section id="numerical-and-mathematical-model-of-fmri-data">
<h3>Numerical and mathematical model of fMRI data<a class="headerlink" href="#numerical-and-mathematical-model-of-fmri-data" title="Permalink to this headline">#</a></h3>
<p>From image processing point of view, fMRI data is a collection of 3D images aquired every TR seconds where TR is the repetition time between two consecutive brain volume acquisitions.</p>
<p>From a signal processing point of view, fMRI data is a collection of time signal with a spatial coherence : each voxel of the brain volume contains a signal and there is a high probability that two neighboring voxels have similar temporal activity. The TR value corresponds to the sampling period of the signal.</p>
<p>As with any multidimensional acquisition system, there is a compromise to be made between the spatial and temporal dimensions of an fMRI dataset. If we want to increase the spatial resolution, i.e. increase the number of voxels in a brain volume, we must increase the TR (and therefore the signal sampling period). Inversely, if we want to increase the temporal resolution of the signals, we must decrease the number of voxels acquired in each volume and thus decrease the spatial resolution.</p>
<p>As the interest of an fMRI examination is to study brain activity over time, it is necessary to privilege temporal resolution over spatial resolution. This is why the anatomical structures of the brain are less clear on the images composing an fMRI data set than for a structural MRI acquisition.</p>
<figure class="align-default" id="fmri">
<a class="reference internal image-reference" href="_images/MRI_fMRI.png"><img alt="_images/MRI_fMRI.png" src="_images/MRI_fMRI.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Comparison of spatial resolutions of strucural (left) and functional (right) MRI data</span><a class="headerlink" href="#fmri" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As stated in the Nyquist–Shannon sampling theorem, with a sampling rate (or sampling frequency) of <span class="math notranslate nohighlight">\(f_s = \frac{1}{TR}\)</span>, to represent a continuous signal whose spectrum is defined on the frequency band [-<span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(B\)</span>] it is necessary that <span class="math notranslate nohighlight">\(f_s \geqslant 2B\)</span>.</p>
</section>
</section>
<section id="studying-fmri-signal-with-signal-processing-tools">
<h2>Studying fMRI signal with signal processing tools<a class="headerlink" href="#studying-fmri-signal-with-signal-processing-tools" title="Permalink to this headline">#</a></h2>
<p>Many signal processing tools are used to analyse fMRI signals :</p>
<ul class="simple">
<li><p>convolution to model physiological process action on BOLD signal,</p></li>
<li><p>harmonic analysis (Fourier transform) for stationary signals,</p></li>
<li><p>wavelet analysis or time-frequency analysis for transient signals,</p></li>
<li><p>low-pass and high-pass filters for removing artifacts, noise, etc.,</p></li>
<li><p>confounding signal regression to remove any nuisance sources before connectivity analysis,</p></li>
<li><p>etc.</p></li>
</ul>
<p>Graph methods are also widely used for the analysis of functional connectivity in fMRI (see the course “Graph theory and connectivity analysis” in class <em>Advanced medical image processing: methods</em>)</p>
</section>
<hr class="docutils" />
<section id="table-of-contents">
<h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="GLM.html">Task fMRI analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lab.html">Lab session : task fMRI analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="FC.html">Resting state functional connectivity: definition and analysis</a></li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='right-next' id="next-link" href="GLM.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Task fMRI analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Céline Meillier<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>