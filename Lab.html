
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lab session : task fMRI analysis &#8212; fMRI data analysis, connectivity study</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Functional connectivity: definition and analysis" href="FC.html" />
    <link rel="prev" title="Task fMRI analysis" href="GLM.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">fMRI data analysis, connectivity study</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction to fMRI data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="GLM.html">
   Task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lab session : task fMRI analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FC.html">
   Functional connectivity: definition and analysis
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FLab.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/Lab.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-images-and-signals-useful-in-this-course">
     Loading images and signals useful in this course
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hemodynamic-response">
     Hemodynamic response
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extraction-of-brain-time-courses">
     Extraction of brain time courses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-linear-model">
   Generalized linear model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-paradigm-design">
     Creating the paradigm design
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-design-matrix">
     Creating the design matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#least-squares-estimation-and-contrast-map">
     Least squares estimation and contrast map
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lab session : task fMRI analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-preparation">
   Data preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-images-and-signals-useful-in-this-course">
     Loading images and signals useful in this course
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hemodynamic-response">
     Hemodynamic response
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extraction-of-brain-time-courses">
     Extraction of brain time courses
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-linear-model">
   Generalized linear model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-paradigm-design">
     Creating the paradigm design
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-design-matrix">
     Creating the design matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#least-squares-estimation-and-contrast-map">
     Least squares estimation and contrast map
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="lab-session-task-fmri-analysis">
<h1>Lab session : task fMRI analysis<a class="headerlink" href="#lab-session-task-fmri-analysis" title="Permalink to this headline">#</a></h1>
<p>In this tutorial we will implement the notions of general linear model, contrast and statistical map seen in class. For this we will use an fMRI acquisition performed by Geraint Rees under the direction of Karl Friston (Functional Imaging Laboratory). The subject of their study was to explore the possibilities offered by functional MRI imaging in its infancy. The data is available to the academic world at  <a class="reference external" href="http://www.fil.ion.ucl.ac.uk/spm/data/auditory/">SPM website</a>. Le jeu de données fourni a été acquis avec un IRM 2T Siemens. The dataset provided was acquired with a Siemens 2T MRI. Each (3D) acquisition is a <span class="math notranslate nohighlight">\(64\times 64\times 64\)</span> matrix with voxels of size  <span class="math notranslate nohighlight">\(3 \times 3 \times 3\)</span> mm<span class="math notranslate nohighlight">\(^3\)</span>. Each 3D acquisition actually takes exactly 6.05s (for the 64 slices) then the acquisitions were finally performed with a repetition time TR = 7s. In the studied dataset, there are 96 acquisitions performed on a subject with a block paradigm.  Each block is composed of 6 acquisitions of silence and 6 acquisitions during which the patient hears bisyllabic words. This gives a paradigm of 8 blocks of 84s.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The subject is written in Matlab, but if you prefer to code in Python, it is also possible. For loading the .mat data, use the following instruction :<br />
from <a class="reference external" href="http://scipy.io">scipy.io</a> import loadmat
data = loadmat(‘filename.mat’)</p>
</div>
</aside>
<p>In this tutorial, the data was pre-processed, the first block of 12 acquisitions was removed and the images were trimmed on the edges (of the 3D cubes).</p>
<p><strong>The objective of this tutorial is to study the brain areas activated by the subject’s hearing of words in MRI.</strong></p>
<hr class="docutils" />
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">#</a></h2>
<p>The pre-processed data is available in the archive ‘data.zip’. Unpack the archive and place the files in your current working directory.</p>
<section id="loading-images-and-signals-useful-in-this-course">
<h3>Loading images and signals useful in this course<a class="headerlink" href="#loading-images-and-signals-useful-in-this-course" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Load the fMRI acquisition contained in the file ‘swfM00223.mat’, the 4D matrix is stored in the variable ‘I’.</p></li>
<li><p>Save the dimensions of image I in 4 variables N1, N2, N3, N4.</p></li>
<li><p>Load the mask contained in the file ‘mask.mat’, the 3D mask is contained in the variable ‘mask’.</p></li>
<li><p>Load the hemodynamic response contained in the file ‘hrf.mat’, the vector is stored in the variable ‘hrf’.</p></li>
</ol>
</section>
<section id="hemodynamic-response">
<h3>Hemodynamic response<a class="headerlink" href="#hemodynamic-response" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>What is the time sampling rate of the data ?</p></li>
<li><p>Display the hemodynamic response provided (it has been sampled with the same frequency as the data). What can be said about this response and the time sampling rate of the fMRI acquisition?</p></li>
</ol>
</section>
<section id="extraction-of-brain-time-courses">
<h3>Extraction of brain time courses<a class="headerlink" href="#extraction-of-brain-time-courses" title="Permalink to this headline">#</a></h3>
<p>Before analysing the fMRI image, we need to extract the voxels belonging to the brain (the skull and everything else in the periphery of the brain is a nuisance for the analysis). We provide a binary mask in the file ‘mask.mat’ which contains 1 in the voxels belonging to the brain and 0 everywhere else.</p>
<ol class="simple">
<li><p>How many voxels does the mask contain? We will store this value in the variable  <span class="math notranslate nohighlight">\(\tt{nbVox}\)</span>.</p></li>
<li><p>Create a matrix Y of size <span class="math notranslate nohighlight">\(N4 \times nbVox\)</span> which will contain in each column the timecourses of the brain voxels.</p></li>
</ol>
<p>In order to extract the timecourses of interest, the following code will be used:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for i = 1:N4

      tmp = squeeze(I(:,:,:,i));

      % Extraction of the 3D acquisition at time i

      Y(i,:) = tmp(mask &gt;0);

end
</pre></div>
</div>
<ol class="simple">
<li><p>Extract the timecourses with the above code.</p></li>
</ol>
<p>We will now work with this matrix Y where each column corresponds to a time course of size <span class="math notranslate nohighlight">\(N4\times 1\)</span> (vector <span class="math notranslate nohighlight">\(y\)</span> in the course formulas).</p>
</section>
</section>
<hr class="docutils" />
<section id="generalized-linear-model">
<h2>Generalized linear model<a class="headerlink" href="#generalized-linear-model" title="Permalink to this headline">#</a></h2>
<section id="creating-the-paradigm-design">
<h3>Creating the paradigm design<a class="headerlink" href="#creating-the-paradigm-design" title="Permalink to this headline">#</a></h3>
<p>According to the description of the experimental paradigm, we want to create a vector that reflects the alternation of audio sequences and sequences of silence.</p>
<ol class="simple">
<li><p>Create the vector <em>paradigm</em> containing the experimental paradigm described in the introduction.</p></li>
<li><p>Display this vector and check that it is consistent with the experiment (the better the vector modelling the paradigm, the better the regression).</p></li>
<li><p>This vector <em>paradigm</em> can be combined with the hemodynamic response to best synthesise the expected response to the audio stimulation. We will call this <em>paradigme_hrf</em> the convoluted paradigm to the haemodynamic response contained in the vector <em>hrf</em>.</p></li>
</ol>
</section>
<section id="creating-the-design-matrix">
<h3>Creating the design matrix<a class="headerlink" href="#creating-the-design-matrix" title="Permalink to this headline">#</a></h3>
<p>Recall that the generalized linear model for a single timecourse is written :</p>
<div class="math notranslate nohighlight">
\[Y = \sum_{i} \beta_i x_i + \epsilon = X\beta + \epsilon\]</div>
<p>where <span class="math notranslate nohighlight">\(x_i\)</span> are known regressors (chosen according to the paradigm!),<span class="math notranslate nohighlight">\(\beta_i\)</span> are the unknown parameters to be estimated.</p>
<p>The model can be represented graphically :</p>
<figure class="align-default" id="glm2">
<a class="reference internal image-reference" href="_images/GLM.png"><img alt="_images/GLM.png" src="_images/GLM.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Matrix model of generalized linear model for fMRI signal.</span><a class="headerlink" href="#glm2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In the matrix  <span class="math notranslate nohighlight">\(X\)</span>  regressors <span class="math notranslate nohighlight">\(p = 3\)</span> are used :</p>
<ul class="simple">
<li><p>a constant vector (to model a possible offset, or the average of the noise if it is non-zero, etc),</p></li>
<li><p>the paradigm vector (convoluted or not to the haemodynamic response)</p></li>
<li><p>a vector <span class="math notranslate nohighlight">\(\tt{meanY}\)</span> which contains the average of the time courses.</p></li>
</ul>
<p>The last regressor is related to the presence of a hypersignal in the ventricles (filled with cerebrospinal fluid) which is found in the average timecourse.</p>
<ol class="simple">
<li><p>Construct the 3 regressors as 3 vectors <span class="math notranslate nohighlight">\(x_1, x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span> of size <span class="math notranslate nohighlight">\(N4 \times 1\)</span> containing the information given above.</p></li>
<li><p>Construct the matrix X by putting in the first column the vector <span class="math notranslate nohighlight">\(x_1\)</span>, in the second column the vector <span class="math notranslate nohighlight">\(x_2\)</span> and in the third column, the vector <span class="math notranslate nohighlight">\(x_3\)</span>.</p></li>
</ol>
</section>
<section id="least-squares-estimation-and-contrast-map">
<h3>Least squares estimation and contrast map<a class="headerlink" href="#least-squares-estimation-and-contrast-map" title="Permalink to this headline">#</a></h3>
<p>The least squares estimator of the vector <span class="math notranslate nohighlight">\(\beta\)</span> containing the 3 regression coefficients is obtained by the equation :</p>
<div class="math notranslate nohighlight">
\[\hat{\beta} = (X^TX)^{-1}X^Ty\]</div>
<p>when <span class="math notranslate nohighlight">\(y\)</span> contains a single timecourse.</p>
<p>We want to calculate here the 3 regression coefficients for all the brain voxels contained in the matrix  <span class="math notranslate nohighlight">\(Y\)</span> of size <span class="math notranslate nohighlight">\(N4\times nbVox\)</span>. The calculation of <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> can be done for all voxels by rewriting the problem in matrix form:</p>
<div class="math notranslate nohighlight">
\[ \hat{\beta} = (X^TX)^{-1}X^TY.\]</div>
<p>This model can be represented graphically:</p>
<figure class="align-default">
<img alt="_images/glm3.png" src="_images/glm3.png" />
</figure>
<ol class="simple">
<li><p>Calculate the matrix <span class="math notranslate nohighlight">\(\hat{\beta}\)</span>.</p></li>
<li><p>Compare the size of the matrix <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> to the size of the 3D brain mask.</p></li>
<li><p>Conclude on how to visualize in 3D the values of <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> for each regressor.</p></li>
</ol>
<p>We are interested in the contrast <span class="math notranslate nohighlight">\(\beta_2 - \beta_3\)</span> where <span class="math notranslate nohighlight">\(\beta_2\)</span> is the regression coefficient related to the paradigm and  <span class="math notranslate nohighlight">\(\beta_3\)</span> is the regression coefficient related to the mean value of the timecourses.</p>
<ol class="simple">
<li><p>Create the vector <span class="math notranslate nohighlight">\(\tt{c}\)</span> of contrast.</p></li>
</ol>
<p>The decision statistic is formed:</p>
<div class="math notranslate nohighlight">
\[T = \frac{c^T\hat{\beta}}{\sqrt{\vphantom{P^T}\hat{\sigma}^2 c^T(X^TX)^{-1}c}}\]</div>
<p>with <span class="math notranslate nohighlight">\(\hat{\sigma}^2 = \frac{1}{n-p-1}\|Y - X\hat{\beta} \|^2_2\)</span></p>
<p>In the matrix case, <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(\hat{\sigma}^2\)</span> are vectors of size <span class="math notranslate nohighlight">\(nbVox \times 1\)</span>.</p>
<p>The density probability function <span class="math notranslate nohighlight">\(p(T|\mathcal{H}_0)\)</span> of the statistics  <span class="math notranslate nohighlight">\(T\)</span> under <span class="math notranslate nohighlight">\(\mathcal{H}_0\)</span> is the Student’s law at <span class="math notranslate nohighlight">\((N4 - p -2)\)</span> degrees of freedom. The distribution function of the Student’s law at <span class="math notranslate nohighlight">\((N4 - p -2)\)</span> degree of freedom is obtained in Matlab with the following code:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>tcdf(T, N4 - p -2)
</pre></div>
</div>
<ol class="simple">
<li><p>Calculate the vector <span class="math notranslate nohighlight">\(\hat{\sigma}^2\)</span>.</p></li>
<li><p>Calculate the vector <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
<li><p>Calculate the vector of p-values.</p></li>
<li><p>Visualise the p-values in 3D using the mask and code of the question 3.</p></li>
<li><p>The p-values can be thresholded for a significance level <span class="math notranslate nohighlight">\(\alpha = 0.01\)</span> to visualise the voxels for which the contrast is most significant.</p></li>
<li><p>Overlay the thresholded map on one of the acquisitions <span class="math notranslate nohighlight">\(I(:,:,:,i)\)</span> to visualise the areas of the brain activated by hearing.</p></li>
<li><p>What are the areas identified using the previous contrast ?</p></li>
<li><p>Do T-test analysis and correlation analysis give the same result? If you have time, you can implement either method to compare the results.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="GLM.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Task fMRI analysis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="FC.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Functional connectivity: definition and analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Céline Meillier<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>